@use "sass:string";
@use "@db-ux/core-foundations/build/styles/variables";
@use "@db-ux/core-foundations/build/styles/screen-sizes";
@use "@db-ux/core-foundations/build/styles/colors";
@use "@db-ux/core-foundations/build/styles/helpers";
@use "../../styles/internal/control-panel-desktop";
@use "../../styles/internal/custom-elements";
@use "../../styles/internal/form-components";

.db-shell {
	// DESKTOP
	@include screen-sizes.screen-min-max(
		(
			min: "sm"
		)
	) {
		&[data-control-panel-desktop-position="left"] {
			grid-template-areas:
				"control-panel sub-navigation"
				"control-panel main";
			grid-template-columns:
				[control-panel] min-content
				[main] 1fr;

			&:has(
					> .db-sub-navigation-container
						> .db-shell-sub-navigation-button:first-child
				) {
				grid-template-areas:
					"control-panel main"
					"control-panel main";
			}

			> .db-sub-navigation-container {
				#{string.unquote(custom-elements.$navigation)} {
					--db-overflow-scroll-button-inset-block: #{variables.$db-spacing-fixed-md};

					> menu {
						--db-navigation-item-group-menu-inset-block-start: #{variables.$db-spacing-fixed-md};

						padding-block: variables.$db-spacing-fixed-md;
					}
				}
			}
		}

		&[data-control-panel-desktop-position="top"] {
			&:not([data-sub-navigation-desktop-position="left"]) {
				grid-template-areas:
					"control-panel"
					"sub-navigation"
					"main";
				grid-template-rows:
					[control-panel] max-content
					[sub-navigation] max-content
					[main] 1fr;

				> .db-sub-navigation-container {
					#{string.unquote(custom-elements.$navigation)} {
						--db-overflow-scroll-button-inset-block: #{variables.$db-spacing-fixed-xs};

						> menu {
							--db-navigation-item-group-menu-inset-block-start: #{variables.$db-spacing-fixed-xs};

							padding-block: variables.$db-spacing-fixed-xs;
						}
					}
				}
			}
		}

		&:not(
				[data-control-panel-desktop-position="top"][data-sub-navigation-desktop-position="left"]
			) {
			> .db-sub-navigation-container {
				border-block-end: variables.$db-border-width-3xs solid
					colors.$db-adaptive-on-bg-basic-emphasis-60-default;

				#{string.unquote(custom-elements.$navigation)} {
					--db-overflow-scroll-button-inset-inline-start: calc(
						#{variables.$db-spacing-fixed-sm} / 2
					);

					display: grid;

					@include control-panel-desktop.horizontal-navigation;

					> menu {
						/* workaround for showing correct scrolling and focus */
						padding-inline: calc(
							#{variables.$db-spacing-fixed-sm} / 2
						);
						margin-inline: calc(
							#{variables.$db-spacing-fixed-sm} / 2
						);
					}
				}

				> .db-shell-sub-navigation-button {
					display: none;
				}
			}
		}

		&[data-control-panel-desktop-position="top"][data-sub-navigation-desktop-position="left"] {
			grid-template:
				[control-panel] "control-panel control-panel" max-content
				[main] "sub-navigation main" 1fr /
				[control-panel] auto
				[main] 1fr;

			> .db-sub-navigation-container {
				display: grid;
				border-inline-end: variables.$db-border-width-3xs solid
					colors.$db-adaptive-on-bg-basic-emphasis-60-default;

				#{string.unquote(custom-elements.$navigation)} {
					max-inline-size: screen-sizes.$db-breakpoint-xs;
				}
			}

			> .db-sub-navigation-container > .db-shell-sub-navigation-button {
				display: flex;

				@media screen and (prefers-reduced-motion: no-preference) {
					.db-button::before {
						transition: transform #{variables.$db-transition-straight-functional};
					}
				}
			}

			&[data-open="false"] {
				> .db-sub-navigation-container {
					inline-size: auto;
					/* stylelint-disable-next-line declaration-property-value-no-unknown */
					inline-size: calc-size(auto, size);
					grid-template-areas: "button";
					grid-template-rows: [button] 1fr;

					#{string.unquote(custom-elements.$navigation)} {
						display: none;
					}

					> .db-shell-sub-navigation-button {
						justify-content: center;

						.db-button {
							block-size: 100%;
							border-radius: 0;

							&::before {
								transform: form-components.$dropdown-icon-transform;
							}
						}
					}
				}
			}

			&[data-open="true"] {
				> .db-sub-navigation-container {
					grid-template-areas:
						"navigation"
						"button";
					grid-template-rows:
						[navigation] 1fr
						[button] auto;

					#{string.unquote(custom-elements.$navigation)} {
						overflow: hidden auto;
						scrollbar-gutter: stable both-edges;

						@include control-panel-desktop.vertical-navigation;

						> menu {
							padding-inline: 0;
						}
					}

					> .db-shell-sub-navigation-button {
						padding-block: variables.$db-spacing-fixed-xs;
						padding-inline: variables.$db-spacing-fixed-lg;
						justify-content: end;
						margin-block-start: auto;

						@include helpers.divider("top");
					}
				}
			}
		}

		#{string.unquote(custom-elements.$control-panel-mobile)} {
			display: none;
		}
	}
}
