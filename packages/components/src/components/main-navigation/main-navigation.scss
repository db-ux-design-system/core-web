@use "@db-ui/foundations/build/scss/variables.global" as var;
@use "@db-ui/foundations/build/scss/helpers/component" as component;
@use "../../styles/db-puls" as puls;
@use "../../styles/form-components" as form;

.db-main-navigation {
	-webkit-tap-highlight-color: transparent; /* for removing the highlight */
	inline-size: 100%;

	@include component.screen("m") {
		-webkit-tap-highlight-color: inherit;
		inline-size: auto;
	}

	& > menu {
		display: flex;
		flex-direction: column;
		padding: 0;
		margin: 0;
		gap: var.$db-spacing-fixed-sm;

		@include component.screen("m") {
			flex-direction: row;
		}

		.db-navigation-item {
			.db-navigation-item-expand-button:is(button),
			.db-navigation-item-expand-button > button {
				// overwrite for main-navigation items
				@include component.screen("m") {
					&::after {
						--icon-margin-before: #{var.$db-spacing-fixed-sm};
						--icon-glyph: "âŒ„";
						transition: form.$dropdown-icon-transition;
					}

					&:hover,
					&:focus-visible,
					&:has(~ .db-sub-navigation:hover),
					&:has(~ .db-sub-navigation:focus-visible),
					&:has(~ .db-sub-navigation:focus-within) {
						&::after {
							transform: form.$dropdown-icon-transform;
						}
					}
				}
			}

			// re overwrite for non main-navigation items
			& > menu {
				.db-navigation-item-expand-button:is(button),
				.db-navigation-item-expand-button > button {
					@include component.screen("m") {
						&::after {
							--icon-glyph: ">";
							--icon-margin-before: auto;
						}

						&:hover,
						&:focus-visible,
						&:has(~ .db-sub-navigation:hover),
						&:has(~ .db-sub-navigation:focus-visible),
						&:has(~ .db-sub-navigation:focus-within) {
							&::after {
								transform: none;
							}
						}
					}
				}
			}

			&[aria-current="page"] {
				// add puls for main-navigation items
				@extend %show-db-puls;

				menu {
					// hide puls for non main-navigation items
					[aria-current="page"] {
						&::after {
							display: none;
						}
					}
				}
			}
		}
	}
}
