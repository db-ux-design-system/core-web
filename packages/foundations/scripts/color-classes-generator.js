/**
 * Generate Color Utilities (Classes and SCSS Placeholders) for color dependencies
 * according to definitions made by DB UI v3
 */

const prefix = 'db';

/**
 * Backgrounds have more than one variant with the same color for text (on-color)
 * e.g. neutral with variants 1-6 or transparent-full and transparent-semi
 */

const generateBGVariants = (value, variant) => {
	const nameEnding = variant ? `-${variant}` : '';
	return `
.${prefix}-bg-${value}${nameEnding} {
    @extend %${prefix}-bg-${value}${nameEnding};

    &-ia,
    &[data-variant="interactive"] {
        @extend %${prefix}-bg-${value}${nameEnding}-ia;
    }

    .db-weak {
        @extend %weak;
    }
}
`;
};

/**
 * Generates color utility classes and scss placeholders for non-interactive and interactive variants
 * of color combination (background-color and color) based on definitions made by DB UI v3
 *
 * @param {*} colorToken scss transform obj generated by styleDictionary
 * @returns scss string
 */
exports.generateColorUtilitityClasses = (colorToken) => {
	let output = `
	@use "variables" as *;
	@use "color-placeholder" as *;
	`;

	for (const [, value] of Object.keys(colorToken).entries()) {
		if (value === 'neutral') {
			// Neutral has multiple default tones
			const neutralTones = ['0', '1', '2', '3', '4'];
			for (const neutralTone of neutralTones) {
				output += generateBGVariants(value, neutralTone);
			}
		} else {
			// Default text and background colors (former 'light' tone)
			output += generateBGVariants(value);
		}

		// Transparent tones
		const transparentTones = ['full', 'semi'];
		for (const transparentTone of transparentTones) {
			output += generateBGVariants(
				value,
				`transparent-${transparentTone}`
			);
		}
	}

	return output;
};
