<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Navigation Logic</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 2rem; }
        .test-structure { border: 1px solid #ccc; padding: 1rem; margin: 1rem 0; }
        li { list-style: none; padding: 0.25rem 0; }
        .group-title { font-weight: bold; color: #666; }
        input { margin-right: 0.5rem; }
    </style>
</head>
<body>
    <h1>Testing Custom Select Navigation Logic</h1>
    
    <div class="test-structure">
        <h3>Option Group Structure (DOM representation):</h3>
        <ul id="option-list">
            <!-- Option Group 1 Title -->
            <li id="group1-title" class="group-title">
                <span>Option group 1</span>
            </li>
            
            <!-- Option Group 1 Items -->
            <li id="g1-opt1">
                <input type="radio" name="test" value="G1:Option 1" />
                G1:Option 1
            </li>
            
            <li id="g1-opt2">
                <input type="radio" name="test" value="G1:Option 2" />
                G1:Option 2
            </li>
            
            <!-- Option Group 2 Title -->
            <li id="group2-title" class="group-title">
                <span>Option group 2</span>
            </li>
            
            <!-- Option Group 2 Items -->
            <li id="g2-opt1">
                <input type="radio" name="test" value="G2:Option 1" />
                G2:Option 1
            </li>
            
            <li id="g2-opt2">
                <input type="radio" name="test" value="G2:Option 2" />
                G2:Option 2
            </li>
        </ul>
    </div>

    <button onclick="testNavigationFromG1Opt2()">Test: Navigate DOWN from G1:Option 2</button>
    <button onclick="testNavigationFromG2Opt1()">Test: Navigate UP from G2:Option 1</button>
    <button onclick="testAllInputs()">Test: List All Inputs</button>

    <div id="output"></div>

    <script>
        function log(message) {
            const output = document.getElementById('output');
            output.innerHTML += '<div>' + message + '</div>';
        }

        function clearLog() {
            document.getElementById('output').innerHTML = '';
        }

        function testNavigationFromG1Opt2() {
            clearLog();
            log('<strong>Testing navigation DOWN from G1:Option 2...</strong>');
            
            const currentLi = document.getElementById('g1-opt2');
            log('Current position: ' + currentLi.textContent.trim());
            
            // Simulate the DB navigation logic
            let nextElement = currentLi.nextElementSibling;
            log('Next sibling: ' + (nextElement ? nextElement.textContent.trim() : 'null'));
            
            while (nextElement) {
                const nextInput = nextElement.querySelector('input');
                if (nextInput) {
                    log('✓ Found next input: ' + nextInput.value);
                    return nextInput; // This should find G2:Option 1
                }
                log('Skipping element (no input): ' + nextElement.textContent.trim());
                nextElement = nextElement.nextElementSibling;
            }
            
            log('❌ No next element found - this would wrap to beginning');
            return null;
        }

        function testNavigationFromG2Opt1() {
            clearLog();
            log('<strong>Testing navigation UP from G2:Option 1...</strong>');
            
            const currentLi = document.getElementById('g2-opt1');
            log('Current position: ' + currentLi.textContent.trim());
            
            // Simulate the DB navigation logic
            let prevElement = currentLi.previousElementSibling;
            log('Previous sibling: ' + (prevElement ? prevElement.textContent.trim() : 'null'));
            
            while (prevElement) {
                const prevInput = prevElement.querySelector('input');
                if (prevInput) {
                    log('✓ Found previous input: ' + prevInput.value);
                    return prevInput; // This should find G1:Option 2
                }
                log('Skipping element (no input): ' + prevElement.textContent.trim());
                prevElement = prevElement.previousElementSibling;
            }
            
            log('❌ No previous element found - this would wrap to end');
            return null;
        }

        function testAllInputs() {
            clearLog();
            log('<strong>All input elements found:</strong>');
            
            const container = document.getElementById('option-list');
            const inputs = Array.from(container.querySelectorAll('input[type="radio"]'));
            
            inputs.forEach((input, index) => {
                log(`${index}: ${input.value} (parent: ${input.closest('li').id})`);
            });
            
            log(`Total inputs: ${inputs.length}`);
        }

        // Run tests automatically
        window.onload = function() {
            log('<strong>Automatic test results:</strong>');
            
            const nextResult = testNavigationFromG1Opt2();
            log('---');
            const prevResult = testNavigationFromG2Opt1();
            log('---');
            testAllInputs();
        };
    </script>
</body>
</html>