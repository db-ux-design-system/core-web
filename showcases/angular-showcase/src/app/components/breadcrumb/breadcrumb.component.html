<app-default-component
	title="DBBreadcrumb"
	[variants]="variants"
	[exampleTemplate]="exampleTemplate"
>
	<ng-template
		#exampleTemplate
		let-exampleProps="exampleProps"
		let-exampleName="exampleName"
		let-exampleIndex="exampleIndex"
		let-variantIndex="variantIndex"
	>
		<!-- Plain HTML structure to avoid relying on missing Angular wrapper / web component -->
		<nav
			[attr.class]="
				'db-breadcrumb' +
				(exampleProps?.className ? ' ' + exampleProps.className : '')
			"
			[attr.data-size]="exampleProps?.size ?? 'small'"
			[attr.data-separator]="exampleProps?.separator"
			aria-label="breadcrumb"
		>
			<ol class="db-breadcrumb-list" role="list">
				@if (
					exampleProps?.maxItems &&
					exampleProps.children.length > exampleProps.maxItems &&
					!isExpanded[variantIndex + "-" + exampleIndex]
				) {
					<!-- Collapsed view: first item + ellipsis + last items -->
					@if (exampleProps.children[0]; as firstItem) {
						<li>
							@if (firstItem.href) {
								<a [href]="firstItem.href">{{
									firstItem.text
								}}</a>
							} @else {
								<span
									[attr.aria-current]="firstItem.ariaCurrent"
									>{{ firstItem.text }}</span
								>
							}
						</li>
					}

					<!-- Ellipsis button -->
					<li>
						<button
							type="button"
							class="db-breadcrumb-ellipsis"
							aria-label="Alle Breadcrumb-Einträge anzeigen"
							(click)="
								toggleExpanded(
									variantIndex + '-' + exampleIndex
								)
							"
						>
							…
						</button>
					</li>

					<!-- Last (maxItems - 1) items -->
					@for (
						item of exampleProps.children.slice(
							-(exampleProps.maxItems - 1)
						);
						track $index
					) {
						<li>
							@if (item.href) {
								<a [href]="item.href">{{ item.text }}</a>
							} @else {
								<span [attr.aria-current]="item.ariaCurrent">{{
									item.text
								}}</span>
							}
						</li>
					}
				} @else {
					<!-- All items (normal or expanded view) -->
					@for (item of exampleProps?.children; track $index) {
						<li>
							@if (item.href) {
								<a [href]="item.href">{{ item.text }}</a>
							} @else {
								<span [attr.aria-current]="item.ariaCurrent">{{
									item.text
								}}</span>
							}
						</li>
					}
				}
			</ol>
		</nav>
	</ng-template>
</app-default-component>
