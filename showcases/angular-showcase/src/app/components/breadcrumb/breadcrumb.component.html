<app-default-component
	title="DBBreadcrumb"
	[variants]="variants"
	[exampleTemplate]="exampleTemplate"
>
	<ng-template
		#exampleTemplate
		let-exampleProps="exampleProps"
		let-exampleName="exampleName"
		let-exampleIndex="exampleIndex"
		let-variantIndex="variantIndex"
	>
		<!-- Plain HTML structure to avoid relying on missing Angular wrapper / web component -->
		<nav
			[attr.class]="
				'db-breadcrumb' +
				(exampleProps?.className ? ' ' + exampleProps.className : '')
			"
			[attr.data-size]="exampleProps?.size ?? 'small'"
			[attr.data-separator]="exampleProps?.separator"
			[attr.aria-label]="exampleProps?.ariaLabel || 'Breadcrumb'"
		>
			<ol class="db-breadcrumb-list" [attr.id]="exampleProps.id || 'db-breadcrumb-list'">
				@if (
					exampleProps?.maxItems &&
					exampleProps.children.length > exampleProps.maxItems &&
					!isExpanded[variantIndex + "-" + exampleIndex]
					) {
					<!-- Collapsed view: first item + ellipsis + last items -->
					@if (exampleProps.children[0]; as firstItem) {
						<li>
							@if (firstItem.href) {
								<a [href]="firstItem.href">
									@if (firstItem.icon) {
										<db-icon
											[icon]="firstItem.icon"
										></db-icon>
									}
									{{ firstItem.text }}
								</a>
							} @else {
								<span>
									@if (firstItem.icon) {
										<db-icon
											[icon]="firstItem.icon"
										></db-icon>
									}
									{{ firstItem.text }}
								</span>
							}
						</li>
					}

					<!-- Ellipsis button -->
					<li>
						<button
							type="button"
							class="db-breadcrumb-ellipsis"
							[attr.aria-label]="exampleProps.ariaLabelExpand || 'Expand breadcrumb items'"
							[attr.aria-controls]="exampleProps.id || 'db-breadcrumb-list'"
							aria-expanded="false"
							(click)="toggleExpanded(variantIndex + '-' + exampleIndex)"
						>
							â€¦
							<db-tooltip>
								{{exampleProps.ellipsisAriaLabel}}
							</db-tooltip>
						</button>
					</li>

					<!-- Last (maxItems - 1) items -->
					@for (
						item of exampleProps.children.slice(
							-(exampleProps.maxItems - 1)
						);
						track $index
					) {
						<li>
							@if (item.href) {
								<a [href]="item.href" [attr.aria-current]="$index === exampleProps.maxItems - 2 ? item.ariaCurrent : null">
									@if (item.icon) {
										<db-icon [icon]="item.icon"></db-icon>
									}
									{{ item.text }}
								</a>
							} @else {
								<span [attr.aria-current]="$index === exampleProps.maxItems - 2 ? item.ariaCurrent : null">
									@if (item.icon) {
										<db-icon [icon]="item.icon"></db-icon>
									}
									{{ item.text }}
								</span>
							}
						</li>
					}
				} @else {
					<!-- All items (normal or expanded view) -->
					@for (item of exampleProps?.children; track $index) {
						<li>
							@if (item.href) {
								<a [href]="item.href" [attr.aria-current]="
									$index === exampleProps.children.length - 1
									  ? item.ariaCurrent
									  : null
								  ">
									@if (item.icon) {
										<db-icon [icon]="item.icon"></db-icon>
									}
									{{ item.text }}
								</a>
							} @else {
								<span [attr.aria-current]="
									$index === exampleProps.children.length - 1
									  ? item.ariaCurrent
									  : null
								  ">
									@if (item.icon) {
										<db-icon [icon]="item.icon"></db-icon>
									}
									{{ item.text }}
								</span>
							}
						</li>
					}
				}
			</ol>
		</nav>
	</ng-template>
</app-default-component>
