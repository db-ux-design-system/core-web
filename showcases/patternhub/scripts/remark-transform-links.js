import { visit } from 'unist-util-visit';

export default function transformLinks() {
	return (tree) => {
		visit(tree, 'link', (node) => {
			if (node.url.endsWith('.md') && !node.url.startsWith('http')) {
				// Remove the .md extension from the URL and transform it from camelCase to kebab-case
				// e.g. `customIcons.md` -> `custom-icons`
				// This is necessary to match the URL of the page generated by Next.js
				node.url = node.url
					.replace(/\.md$/, '')
					.replaceAll(/([a-z])([A-Z])/g, '$1-$2')
					.toLowerCase();
			}
		});
	};
}
