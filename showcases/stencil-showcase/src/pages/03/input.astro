---
import DefaultLayout from '../../layouts/default/DefaultLayout.astro';
import DefaultComponent from '../../components/default/DefaultComponent.astro';
import defaultComponentVariants from '../../../../shared/input.json';
import type { DBInputProps } from '@components';
import { getPropsAsAttributes, getVariantsWithExamples } from '../../utils';

const exampleFn = ({
	label,
	value,
	type,
	minLength,
	required,
	disabled,
	iconTrailing,
	showIcon,
	showIconTrailing,
	icon,
	children,
	message,
	variant,
	readOnly,
	dataList,
	showLabel,
	showMessage,
	validMessage,
	validation,
	invalidMessage,
	showRequiredAsterisk,
	maxLength,
	max,
	min,
}: DBInputProps & { dataList?: boolean }) => {
	const id = Math.random().toString(36).substring(2, 15);
	const dataListValue =
		variant === 'floating'
			? JSON.stringify(['Test 1', 'Test 2'])
			: JSON.stringify([
					{ value: 'test1', label: 'Test 1' },
					{ value: 'test2', label: 'Test 2' },
				]);

	const props = {
		id,
		label,
		message,
		placeholder: children,
		variant,
		'show-label': showLabel,
		'show-required-asterisk': showRequiredAsterisk,
		value,
		type,
		'min-length': minLength,
		required,
		disabled,
		'read-only': readOnly,
		'icon-trailing': iconTrailing,
		'show-icon-trailing': showIconTrailing,
		'max-length': maxLength,
		max,
		min,
		icon,
		'show-icon': showIcon,
		'show-message': showMessage,
		'invalid-message': invalidMessage,
		'valid-message': validMessage,
		validation,
	};

	const dataListScript = dataList
		? `<script>
		document.querySelector('db-input[id="${id}"]').dataList = ${dataListValue};
</script>`
		: '';

	return `<db-input ${getPropsAsAttributes(props)}></db-input>
${dataListScript}
`;
};
const variants = getVariantsWithExamples<DBInputProps & { dataList?: boolean }>(
	defaultComponentVariants,
	exampleFn,
);
---

<DefaultLayout>
	<DefaultComponent title="DBInput" variants={variants} />
</DefaultLayout>
