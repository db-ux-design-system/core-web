const P=t=>{const{top:r,bottom:e,left:g,right:d}=t.getBoundingClientRect(),{innerHeight:h,innerWidth:b}=window;let f=r<0,p=e>h,x=g<0,l=d>b;const $=t.dataset.outsideVy,y=t.dataset.outsideVx,n=t?.parentElement?.getBoundingClientRect();return n&&($&&(t.dataset.outsideVy==="top"?f=n.top-(e-n.bottom)<0:p=n.bottom+(n.top-r)>h),y&&(t.dataset.outsideVx==="left"?x=n.left-(d-n.right)<0:l=n.right+(n.left-g)>b)),{outTop:f,outBottom:p,outLeft:x,outRight:l}},B=t=>{const{outTop:r,outBottom:e,outLeft:g,outRight:d}=P(t);let h={};return r||e?(h={vy:r?"top":"bottom"},t.dataset.outsideVy=h.vy):delete t.dataset.outsideVy,g||d?(h={...h,vx:d?"right":"left"},t.dataset.outsideVx=h.vx):delete t.dataset.outsideVx,h},k=(t,r,e)=>{if(getComputedStyle(t).zIndex==="9999")return;const{top:g,bottom:d,childHeight:h,childWidth:b,width:f,right:p,left:x,correctedPlacement:l}=w(t,r,e);t.dataset.width==="full"&&(t.style.inlineSize=`${f}px`),l==="top"||l==="bottom"||l==="top-start"||l==="bottom-start"?t.style.insetInlineStart=`${x}px`:(l==="top-end"||l==="bottom-end")&&(t.style.insetInlineStart=`${p-b}px`),l?.startsWith("top")?t.style.insetBlockStart=`${g-h}px`:l?.startsWith("bottom")&&(t.style.insetBlockStart=`${d}px`),t.style.position="fixed"},w=(t,r,e)=>{if(!t||!r)return{top:0,bottom:0,right:0,height:0,width:0,left:0,childHeight:0,childWidth:0,correctedPlacement:e,innerWidth:window.innerWidth,innerHeight:window.innerHeight};const g=t.getBoundingClientRect(),{top:d,height:h,bottom:b,right:f,left:p,width:x}=r.getBoundingClientRect(),{innerHeight:l,innerWidth:$}=window;let y=g.height,n=g.width;(e==="bottom"||e==="top")&&(n=n/2),(e==="left"||e==="right")&&(y=y/2);const a=b+y>l,c=d-y<0,s=p-n<0,u=f+n>$;let o=e;return e.startsWith("bottom")?a?(o=e?.replace("bottom","top"),s&&u?o="top":s?o="top-start":u&&(o="top-end")):s&&u?o="bottom":s?o="bottom-start":u&&(o="bottom-end"):e.startsWith("top")?c?(o=e?.replace("top","bottom"),s&&u?o="bottom":s?o="bottom-start":u&&(o="bottom-end")):s&&u?o="top":s?o="top-start":u&&(o="top-end"):e.startsWith("left")?s?(o=e?.replace("left","right"),a&&c?o="right":a?o="right-end":c&&(o="right-start")):a&&c?o="left":a?o="left-end":c&&(o="left-start"):o.startsWith("right")&&(u?(o=e?.replace("right","left"),a&&c?o="left":a?o="left-end":c&&(o="left-start")):a&&c?o="right":a?o="right-end":c&&(o="right-start")),{top:d,bottom:b,right:f,height:h,width:x,left:p,childHeight:g.height,childWidth:g.width,correctedPlacement:o,innerWidth:$,innerHeight:l}};const W=new WeakMap,S=t=>{if(W.has(t))return W.get(t);let r=t.parentElement,e=0;for(;r&&e<10;){if(r.dataset.correctedPlacement)return W.set(t,r),r;r=r.parentElement,e+=1}return W.set(t,null),null},E=(t,r,e)=>{const g=getComputedStyle(r),d=["absolute","fixed"].includes(g.position),h=S(t),b=!h&&!d,f=getComputedStyle(t)?.getPropertyValue("--db-popover-distance")??"0px";let{top:p,height:x,width:l,childHeight:$,childWidth:y,right:n,left:a,bottom:c,correctedPlacement:s,innerWidth:u,innerHeight:o}=w(t,r,e);if(h){const i=h.getBoundingClientRect();a=Math.abs(a-i.left),n=(l+Math.abs(n-i.right))*1.5,p=Math.abs(p-i.top),c=(x+Math.abs(c-i.bottom))*1.5}if(d&&(a=0,n=l,p=0,c=x,["auto","inherit","0"].includes(g.zIndex)&&(r.style.zIndex="1")),y>l&&(s.startsWith("bottom")||s.startsWith("top"))){const i=l/2/y*100;s.endsWith("start")?t.style.setProperty("--db-tooltip-arrow-inline-start",`${i}%`):s.endsWith("end")?t.style.setProperty("--db-tooltip-arrow-inline-start",`${100-i}%`):t.style.setProperty("--db-tooltip-arrow-inline-start","50%")}if($>x&&(s.startsWith("left")||s.startsWith("bottom"))){const i=x/2/$*100;s.endsWith("start")?t.style.setProperty("--db-tooltip-arrow-block-start",`${i}%`):s.endsWith("end")?t.style.setProperty("--db-tooltip-arrow-block-start",`${100-i}%`):t.style.setProperty("--db-tooltip-arrow-block-start","50%")}if(s==="right"||s==="left")t.style.insetBlockStart=`${p+x/2}px`;else if(s==="right-start"||s==="left-start"){const i=p+$;t.style.insetBlockStart=`${p}px`,t.style.insetBlockEnd=`${!d&&i>o?o:i}px`}else if(s==="right-end"||s==="left-end"){const i=c-$;t.style.insetBlockStart=`${!d&&i<0?0:i}px`,t.style.insetBlockEnd=`${c}px`}else if(s==="top"||s==="bottom")t.style.insetInlineStart=`${a+l/2}px`;else if(s==="top-start"||s==="bottom-start"){const i=a+y;t.style.insetInlineStart=`${a}px`,t.style.insetInlineEnd=`${!d&&i>u?u:i}px`}else if(s==="top-end"||s==="bottom-end"){const i=n-y;t.style.insetInlineStart=`${!d&&i<0?0:i}px`,t.style.insetInlineEnd=`${n}px`}if(s?.startsWith("right")){const i=n+y;t.style.insetInlineStart=`calc(${n}px + ${f})`,t.style.insetInlineEnd=`calc(${b&&i>u?u:i}px + ${f})`}else if(s?.startsWith("left")){const i=a-y;t.style.insetInlineStart=`calc(${b&&i<0?0:i}px - ${f})`,t.style.insetInlineEnd=`calc(${n}px - ${f})`}else if(s?.startsWith("top")){const i=p-$;t.style.insetBlockStart=`calc(${b&&i<0?0:i}px - ${f})`,t.style.insetBlockEnd=`calc(${d?i:c}px - ${f})`}else if(s?.startsWith("bottom")){const i=c+$;t.style.insetBlockStart=`calc(${d?i:c}px + ${f})`,t.style.insetBlockEnd=`calc(${b&&i>o?o:i}px + ${f})`}t.style.position="fixed",t.dataset.correctedPlacement=s};export{E as a,B as b,k as h};
